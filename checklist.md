# Последовательность проверок метрик web приложения

## Инструменты для проверки

1. [https://developers.google.com/speed/pagespeed/insights/](https://developers.google.com/speed/pagespeed/insights/)
2. [https://squoosh.app/](https://squoosh.app/)
3. [https://github.com/isv9/web-audit](https://github.com/isv9/web-audit)

## Метрики загрузки страницы

Список основных проверок
1. Проверить что нет \<script> до основного контента. Все \<script> должны быть в конце body
2. Проверить все \<script> не относящиеся к приложению имеют атрибут async или defer
3. Проверить что загружаемые stylesheets перед контентом не имеют лишних правил
4. Проверить что все загружаемые ресурсы минифицированы и не содержат ничего лишнего не относящегося к конкретной странице
5. Проверить что используется  HTTP caching


### Время загрузки первого контента First Contentful Paint (FCP)

Это параметр показывающий время отрисовки первого байта на странице. Он достаточно важный так как показывает пользователю что страница загружается.

Рекомендацию по его улучшению

1. Надо минимизировать количество внешних таблиц стилей и скриптов, блокирующих рендеринг, от которых зависит страница. Надо проверить что перед полезным контентом страницы не загружается ничего лишнего тормозящего основной поток(например \<script> без async или defer или лишний css не влияющий на текущее отображение) но лучше всего все \<script>  уносить в конец тэга body
2. Использовать HTTP caching
3. Использовать минификацию ресурсов
4. Оптимизировать скрипты то есть использовать разбиение кода на фрагменты и загружать их по требованию(lazy loading) и использовать механизмы удаления лишнего кода


### Время загрузки основного количества контента First Meaningful Paint (FMP)

### Время загрузки для взаимодействия Time to interactive (TTI)

Параметр показывает через какое время страница стала доступна для взаимодействия с пользователем. Это интервал от старта загрузки приложения до момента когда главный поток бездействует более 5 секунд. Чем выше этот параметр тем хуже создается впечатление пользователя так как ему приходится ждать чтобы начать взаимодействовать с приложением.

Для его улучшения надо минимизировать количество исполняемого js при загрузке страницы


### Задержка от начала взаимодействия пользователя до начала отклика приложения First Input Delay (FID)

## Изображения и медиаматериалы

Список основных проверок

1. Проверяем что изображения загружаются оптимизированными (позволит уменьшить объем передаваемых данных и ускорение отображения изображения на странице)
2. Проверяем какое количество от общего загружаемого размера составляют изображения
3. Проверить что при инициализации приложения не происходит загрузки изображений не отображаемых в видимой части страницы
4. Проверить что форматы изображений используются по назначению, например для изображения фотографического типа у которого нет прозрачных частей не нужно использовать png
5. Проверить что изображения являются отзывчивыми к изменению плотности пикселей экрана и изменению размера viewport (например чтобы для retina дисплея загружалась 2x изображения и для мобильного устройства загружалось изображение меньшего размера чем для desktop )
6. Проверить что используется возможность выбора оптимального формата для этого изображения (использования \<img> с srcset или \<picture> с source)


## Шрифты

Размер шрифта сильно влияет на отображение контента на странице. При подключении шрифта через @font-face нужно указывать стратегию поведения замены шрифта [https://developer.mozilla.org/en/docs/Web/CSS/@font-face/font-display](https://developer.mozilla.org/ru/docs/Web/CSS/@font-face/font-display) Лучшими значениями font-display является swap или fallback они предотвращают резкое появление большого количества текста

Список основных проверок

1. Проверить шрифт разбит на начертания
2. Проверить что шрифты вычищены от неиспользованных начертаниях
3. Проверить что страница инициализируется только с основными начертаниями чтобы лишнии начертания не тормозили инициализацию страницы. Может использоваться \<link rel=”preload”> но только содержать основное начертания для быстрого отображения
4. Проверить что используется возможность браузеры выбирать оптимальный формат контейнера шрифтов (woff2, woff ...) для этого используется src в @font-face. Так же в src можно первым параметром установить проверку на наличие этого шрифта в системе


## Структура DOM

Список основных проверок

1. Проверить что общее количество нод не превышает 1500, если это значение выше браузер начинает тратить слишком много ресурсов на взаимодействие с dom и тем самым тормозит
2. Проверить что нет слишком большой вложенности нод. Оптимальные показатели: глубина дерева – менее 32 элементов, количество дочерних и родительских элементов – менее 60. Сложная структура DOM может привести к использованию большего объема памяти


## Семантика

**Семантика** (с лингвистической точки зрения) – это смысл, информационное содержание языка или отдельной его единицы. Это говорит о том что на странице должны применяться теги сами по себе говорящие что за контент они содержат. Страница не должна состоять только из div. **\<div>** является базовым контейнером для элементов основного потока ( flow content ). Он не влияет на контент или формат пока не стилизован, используя CSS. Являясь "чистым" контейнером, элемент \<div> по своему существу не представляет ничего. [https://webref.ru/course/html-basics/semantics](https://webref.ru/course/html-basics/semantics)

Общие элементы не несущие какого-либо смысла

1. div
2. span

Список основных проверок

1. На странице должен быть \<main>
2. На странице должен быть \<header> и \<h1>
3. На странице не более **одного** тега \<h1>
4. Проверить присутствия семантических тегов 
5. Проверить что на страница не содержит большого количества div и span
6. Проверить что на страница не содержит лишних пустых ссылок и элементов
7. Проверить что на страница не содержит устаревших тегов